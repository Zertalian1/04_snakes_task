==Змейка по сети==

Реализовать многопользовательскую игру "Змейка".
Управляя своей змейкой, нужно поедать "еду" и расти, при этом избежав столкновения с "телом" своей змейки и со змейками, управляемыми другими игроками.

Далее упоминается конфиг игры, все параметры конфига задаются перед стартом игры и после этого не меняются.
Возможные значения параметров указаны в файле описания протокола (snakes.proto).

Игровое поле - прямоугольник со сторонами, заданными в конфиге игры.
Горизонтальные ряды клеток назовём строками, вертикальные - столбцами.
При этом поле логически замкнуто с противоположных сторон: с самой левой клетки строки можно перейти влево на самую правую клетку той же строки, аналогично для самой верхней клетки столбца (математически это дискретный тор).
Змейка представляет из себя последовательность клеток на игровом поле, образующих непрерывную ломаную линию с прямыми углами изгиба (см. рисунок).
Таким образом, змейка может пересекать границы поля неограниченное число раз.
Клетка на одном из концов змейки - голова, направлением движения которой управляет игрок, клетка на противоположном конце - хвост.
На поле могут быть расположены одна или более змеек, каждой змейкой управляет один игрок.
Также на поле в каждый момент времени присутствует еда в количестве, заданном в конфиге игры.
Каждая еда занимает 1 клетку.

Время в игре дискретное, состояния сменяются через интервал реального времени в миллисекундах, заданный в конфиге.
За время между сменами состояния (за один "ход") у игроков есть возможность сменить направление головы своей змейки с помощью команды SteerMsg.
Если команда заставляет змейку повернуть в направлении, занятом соседней с головой клеткой (попытка повернуть вспять), то такая команда игнорируется.
Игрок может успеть заменить предыдущую команду путём отправки новой команды, но если команда не успела дойти до момента смены состояния, то она применяется на следующем ходе.

В момент смены состояния голова каждой змейки пытается продвинуться на 1 клетку в текущем своём направлении.
Далее всё зависит от состояния целевой клетки, куда должна перейти голова:
1. Если целевая клетка была занята змейкой (своей или чужой - неважно, но не хвостом змейки), то "врезавшаяся" змейка погибает, а игрок выбывает из игры. Клетки, которые занимала погибшая змейка (до перемещения головы), с заданной в конфиге вероятностью превращаются в еду, а остальные клетки становятся пустыми. Змейка, в которую "врезались", зарабатывает +1 балл (если она не врезалась сама в себя, конечно).
2. Если целевая клетка была пуста, но на неё на этом ходу должны перейти также и головы других змеек, то все эти змейки погибают таким же образом, как в п.1.
3. Если клетка была пуста, и на неё на этом ходу не переходит больше ни одна другая голова, то все последующие клетки змейки продвигаются на место предыдущих, а клетка, на которой находился хвост, освобождается.
4. Если целевая клетка была занята хвостом любой змейки, которая не съела еду на этом ходе, т.е. её хвост на этом ходе должен убраться с целевой клетки, то такая ситуация обрабатывается так, как будто клетка пуста (п.3).
5. В остальных случаях, если на целевой клетке была еда, то остальные клетки змейки не двигаются, таким образом змейка становится на одну клетку длиннее, и игрок зарабатывает +1 балл.

Таким образом можно, например, вплотную преследовать свой собственный (или чужой хвост), не погибая.
Но если при этом чужая змейка съест еду, то мы на этом ходу "врежемся" в её хвост.

...to be continued...